<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>:: 노래방 예약</title>
    <link rel="stylesheet" href="/css/common.css" />
    <link rel="stylesheet" href="/css/kkReservationUI.css" />

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@100..900&display=swap"
      rel="stylesheet"
    />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC"
      crossorigin="anonymous"
    />
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
      crossorigin="anonymous"
    ></script>
  </head>

  <body>
    <!-- 모바일 컨테이너 -->
    <div id="mobileContainer">
      <!--헤더-->
      <header>
        <img src="/img/left arrow.svg" alt="이전 페이지 이동" />
        <span>스타버스 코인노래방</span>
      </header>
      <!-- 컨텐츠 컨테이너 -->
      <div id="container">
        <div class="infoTxt">* <span>보라색</span>은 청소시간입니다.</div>
        <div class="timeTableContainer">
          <div class="timeLine"></div>
          <div class="roomNTimeTableContainer">
            <div class="contents timeTable-row">
              <div id="roomTypeName" class="roomType btn">2인실 (1)</div>
              <div class="timeRow">
                <div class="time emptyTime" style="width: 105px"></div>

                <div
                  class="time usedTime"
                  data-bs-toggle="popover"
                  data-bs-trigger="hover"
                  data-bs-content="18:00~18:25 예약 불가"
                  style="width: 105px"
                ></div>
                <div
                  class="time cleaningTime"
                  data-bs-toggle="popover"
                  data-bs-trigger="hover"
                  data-bs-content="18:00~18:25 예약 불가"
                  style="width: 30px"
                ></div>
              </div>
            </div>
            <div class="contents timeTable-row">
              <div id="roomTypeName" class="roomType btn">2인실 (1)</div>
              <div class="timeRow">
                <div class="time emptyTime" style="width: 105px"></div>

                <div
                  class="time usedTime"
                  data-bs-toggle="popover"
                  data-bs-trigger="hover"
                  data-bs-content="18:00~18:25 예약 불가"
                  style="width: 105px"
                ></div>
                <div
                  class="time cleaningTime"
                  data-bs-toggle="popover"
                  data-bs-trigger="hover"
                  data-bs-content="18:00~18:25 예약 불가"
                  style="width: 30px"
                ></div>
              </div>
            </div>
            <div class="contents timeTable-row">
              <div id="roomTypeName" class="roomType btn">2인실 (1)</div>
              <div class="timeRow">
                <div class="time emptyTime" style="width: 105px"></div>

                <div
                  class="time usedTime"
                  data-bs-toggle="popover"
                  data-bs-trigger="hover"
                  data-bs-content="18:00~18:25 예약 불가"
                  style="width: 105px"
                ></div>
                <div
                  class="time cleaningTime"
                  data-bs-toggle="popover"
                  data-bs-trigger="hover"
                  data-bs-content="18:00~18:25 예약 불가"
                  style="width: 30px"
                ></div>
              </div>
            </div>
            <div class="contents timeTable-row">
              <div id="roomTypeName" class="roomType btn">2인실 (1)</div>
              <div class="timeRow">
                <div class="time emptyTime" style="width: 105px"></div>

                <div
                  class="time usedTime"
                  data-bs-toggle="popover"
                  data-bs-trigger="hover"
                  data-bs-content="18:00~18:25 예약 불가"
                  style="width: 105px"
                ></div>
                <div
                  class="time cleaningTime"
                  data-bs-toggle="popover"
                  data-bs-trigger="hover"
                  data-bs-content="18:00~18:25 예약 불가"
                  style="width: 30px"
                ></div>
              </div>
            </div>
            <div class="contents timeTable-row">
              <div id="roomTypeName" class="roomType btn">2인실 (1)</div>
              <div class="timeRow">
                <div class="time emptyTime" style="width: 105px"></div>

                <div
                  class="time usedTime"
                  data-bs-toggle="popover"
                  data-bs-trigger="hover"
                  data-bs-content="18:00~18:25 예약 불가"
                  style="width: 105px"
                ></div>
                <div
                  class="time cleaningTime"
                  data-bs-toggle="popover"
                  data-bs-trigger="hover"
                  data-bs-content="18:00~18:25 예약 불가"
                  style="width: 30px"
                ></div>
              </div>
            </div>
            <div class="contents timeTable-row">
              <div id="roomTypeName" class="roomType btn">2인실 (1)</div>
              <div class="timeRow">
                <div class="time emptyTime" style="width: 105px"></div>

                <div
                  class="time usedTime"
                  data-bs-toggle="popover"
                  data-bs-trigger="hover"
                  data-bs-content="18:00~18:25 예약 불가"
                  style="width: 105px"
                ></div>
                <div
                  class="time cleaningTime"
                  data-bs-toggle="popover"
                  data-bs-trigger="hover"
                  data-bs-content="18:00~18:25 예약 불가"
                  style="width: 30px"
                ></div>
              </div>
            </div>
            <div class="contents timeTable-row">
              <div id="roomTypeName" class="roomType btn">2인실 (1)</div>
              <div class="timeRow">
                <div class="time emptyTime" style="width: 105px"></div>

                <div
                  class="time usedTime"
                  data-bs-toggle="popover"
                  data-bs-trigger="hover"
                  data-bs-content="18:00~18:25 예약 불가"
                  style="width: 105px"
                ></div>
                <div
                  class="time cleaningTime"
                  data-bs-toggle="popover"
                  data-bs-trigger="hover"
                  data-bs-content="18:00~18:25 예약 불가"
                  style="width: 30px"
                ></div>
              </div>
            </div>
            <div class="contents timeTable-row">
              <div id="roomTypeName" class="roomType btn">2인실 (1)</div>
              <div class="timeRow">
                <div class="time emptyTime" style="width: 105px"></div>

                <div
                  class="time usedTime"
                  data-bs-toggle="popover"
                  data-bs-trigger="hover"
                  data-bs-content="18:00~18:25 예약 불가"
                  style="width: 105px"
                ></div>
                <div
                  class="time cleaningTime"
                  data-bs-toggle="popover"
                  data-bs-trigger="hover"
                  data-bs-content="18:00~18:25 예약 불가"
                  style="width: 30px"
                ></div>
              </div>
            </div>
            <div class="contents timeTable-row">
              <div id="roomTypeName" class="roomType btn">2인실 (1)</div>
              <div class="timeRow">
                <div class="time emptyTime" style="width: 105px"></div>

                <div
                  class="time usedTime"
                  data-bs-toggle="popover"
                  data-bs-trigger="hover"
                  data-bs-content="18:00~18:25 예약 불가"
                  style="width: 105px"
                ></div>
                <div
                  class="time cleaningTime"
                  data-bs-toggle="popover"
                  data-bs-trigger="hover"
                  data-bs-content="18:00~18:25 예약 불가"
                  style="width: 30px"
                ></div>
              </div>
            </div>
            <div class="contents timeTable-row">
              <div id="roomTypeName" class="roomType btn">2인실 (1)</div>
              <div class="timeRow">
                <div class="time emptyTime" style="width: 105px"></div>

                <div
                  class="time usedTime"
                  data-bs-toggle="popover"
                  data-bs-trigger="hover"
                  data-bs-content="18:00~18:25 예약 불가"
                  style="width: 105px"
                ></div>
                <div
                  class="time cleaningTime"
                  data-bs-toggle="popover"
                  data-bs-trigger="hover"
                  data-bs-content="18:00~18:25 예약 불가"
                  style="width: 30px"
                ></div>
              </div>
            </div>
            <div class="contents timeTable-row">
              <div id="roomTypeName" class="roomType btn">2인실 (1)</div>
              <div class="timeRow">
                <div class="time emptyTime" style="width: 105px"></div>

                <div
                  class="time usedTime"
                  data-bs-toggle="popover"
                  data-bs-trigger="hover"
                  data-bs-content="18:00~18:25 예약 불가"
                  style="width: 105px"
                ></div>
                <div
                  class="time cleaningTime"
                  data-bs-toggle="popover"
                  data-bs-trigger="hover"
                  data-bs-content="18:00~18:25 예약 불가"
                  style="width: 30px"
                ></div>
              </div>
            </div>
            <div class="contents timeTable-row">
              <div id="roomTypeName" class="roomType btn">2인실 (1)</div>
              <div class="timeRow">
                <div class="time emptyTime" style="width: 105px"></div>

                <div
                  class="time usedTime"
                  data-bs-toggle="popover"
                  data-bs-trigger="hover"
                  data-bs-content="18:00~18:25 예약 불가"
                  style="width: 105px"
                ></div>
                <div
                  class="time cleaningTime"
                  data-bs-toggle="popover"
                  data-bs-trigger="hover"
                  data-bs-content="18:00~18:25 예약 불가"
                  style="width: 30px"
                ></div>
              </div>
            </div>
          </div>

          <!-- 예약하기 모달(#modal1) -->
          <div id="modal1" class="modal reservationContainer">
            <div class="modalWrapper">
              <div class="closeIconWrapper">
                <img
                  src="../img/close.svg"
                  alt="모달창 닫기"
                  class="closeBtn"
                />
              </div>
              <div class="reservationFormContainer">
                <p class="modalTitle">예약하기</p>
                <div class="roomSelecBoxContainer">
                  <div class="roomBox">
                    <button class="label">예약하실 방을 선택해주세요.</button>
                    <img src="../img/down arrow.svg" alt="드롭다운" />
                    <ul class="roomList"></ul>
                  </div>
                </div>
                <div class="reservationTimeFormContainer">
                  <p class="reservateDate"></p>
                  <div class="timeWrapper">
                    <div class="timeType">시작 시간</div>
                    <div class="timeSettingWrapper">
                      <div id="startTime" class="timeSettingItem">
                        <input id="hiddenTime1" type="hidden" />
                        <input
                          id="startTimeInput"
                          readonly
                          placeholder="-- : --"
                          value=""
                        />
                        <img src="../img/down arrow.svg" alt="드롭다운" />
                      </div>
                    </div>
                  </div>
                  <div class="timeWrapper">
                    <div class="timeType">이용 시간</div>
                    <div class="timeSettingWrapper">
                      <div id="hoursOfUse" class="timeSettingItem item3">
                        <input id="hiddenTime2" type="hidden" />
                        <input readonly placeholder="-- : --" />
                        <img src="../img/down arrow.svg" alt="드롭다운" />
                      </div>
                    </div>
                  </div>
                  <div class="timeWrapper">
                    <div class="timeType">이용 종료 시간</div>
                    <div class="timeSettingWrapper">
                      <div id="endTime" class="timeSettingItem">
                        <input id="hiddenTime3" type="hidden" />
                        <input
                          id="endTimeInput"
                          readonly
                          placeholder="-- : --"
                        />
                      </div>
                    </div>
                  </div>
                  <div class="m1btnContainer">
                    <div class="btn cancel">취소</div>
                    <div class="btn submit">예약</div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <!-- 하단 메뉴바 -->
      </div>
      <nav>
        <div id="reservationBtn" class="reservation btn">예약하기</div>
      </nav>

      <script>
        //bootstrap popover
        var popoverTriggerList = [].slice.call(
          document.querySelectorAll('[data-bs-toggle="popover"]')
        );
        var popoverList = popoverTriggerList.map(function (popoverTriggerEl) {
          return new bootstrap.Popover(popoverTriggerEl);
        });
      </script>

      <!-- 시작시간 설정 모달(#modal2) -->
      <div id="modal2" class="modal startTime">
        <div class="modalContent">
          <div class="searchDate"></div>
          <div class="timeSettingWrapper">
            <div class="timeTypeWrapper">
              <div class="timeType">AM</div>
              <div class="timeType">PM</div>
            </div>
            <div class="timeWrapper">
              <div id="hour" class="time">
                <p>시</p>
                <input name="hour" type="number" />
              </div>
              <span>:</span>
              <div id="minute" class="time">
                <p>분</p>
                <input name="minute" type="number" required />
              </div>
            </div>
          </div>
          <div class="btnWrapper">
            <div class="btn cancel">취소</div>
            <div class="btn setting">설정</div>
          </div>
        </div>
      </div>

      <!-- 이용시간 설정 모달(#modal3) -->
      <div id="modal3" class="modal usingTime">
        <div class="modalContent">
          <p class="subTitle">이용 시간</p>
          <div class="timeWrapper">
            <div id="hour" class="time">
              <p>시</p>
              <input name="hour" type="number" />
            </div>
            <span>:</span>
            <div id="minute" class="time">
              <p>분</p>
              <input name="minute" type="number" required />
            </div>
          </div>
          <div class="btnContainer">
            <div id="usingTimeCancelBtn" class="btn cancel">취소</div>
            <div id="usingTimeSettingBtn" class="btn setting">설정</div>
          </div>
        </div>
      </div>

      <!-- 예약 내용 확인 모달(#modal4) -->
      <div id="modal4" class="modal checkReservation">
        <div class="modalWrapper">
          <div class="closeIconWrapper">
            <img src="../img/close.svg" alt="모달창 닫기" class="closeBtn" />
          </div>
          <div class="reservationFormContainer">
            <p class="modalTitle">예약 내용을<br />다시 한 번 확인해주세요</p>
            <div class="kkRoomInfo">
              <span class="kkRoomName"></span>
              <!--선택한 노래방 상호명_피그마: 스타버스 코인노래방-->
              <span class="kkRoomType"></span>
              <!--#modal1에서 선택한 노래방 타입-->
            </div>
            <div class="reservateDate"></div>
            <div class="reservationTimeFormContainer">
              <div class="timeWrapper">
                <div class="timeType">시작 시간</div>
                <div class="timeSettingWrapper">
                  <div id="startTime" class="timeSettingItem">
                    <input id="hiddenTime1" type="hidden" />
                    <input
                      id="startTimeInput"
                      readonly
                      placeholder="-- : --"
                      value=""
                    />
                  </div>
                </div>
              </div>
              <div class="timeWrapper">
                <div class="timeType">이용 시간</div>
                <div class="timeSettingWrapper">
                  <div id="hoursOfUse" class="timeSettingItem item3">
                    <input id="hiddenTime2" type="hidden" />
                    <input readonly placeholder="-- : --" />
                  </div>
                </div>
              </div>
              <div class="timeWrapper">
                <div class="timeType">이용 종료 시간</div>
                <div class="timeSettingWrapper">
                  <div id="endTime" class="timeSettingItem">
                    <input id="hiddenTime3" type="hidden" />
                    <input id="endTimeInput" readonly placeholder="-- : --" />
                  </div>
                </div>
              </div>
              <p class="paymentInfo">결제금액: <span>4,000</span>원</p>
              <div class="m4btnContainer">
                <div class="btn back">이전</div>
                <!--클릭 시, #modal4 창 닫고, #modal3 보이기-->
                <div class="btn submit">결제</div>
                <!--클릭 시, #modal4 창 닫고,결제 완료 모달(#modal5) 보이기-->
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- 결제 및 예약 완료 모달(#modal5) -->
    <div id="modal5" class="modal5Background">
      <div class="modal">
        <div class="contentsContainer">
          <p class="largeTxt">결제 및 예약이<br />확정되었습니다.</p>
          <p class="smallTxt">
            이용 시작 <span>20분 전</span>부터는 취소 수수료가<br />부과되는 점
            참고해주세요!
          </p>
          <div class="btn">나의 예약 보기</div>
        </div>
      </div>
    </div>

    <!-- 하단 메뉴바 -->
    <nav>
      <div id="reservationBtn" class="reservation btn">예약하기</div>
    </nav>

    <script>
       // let kkRoomCnt = $(".roomType").length;
       let kkRoomCnt = 12;  // 노래방 방 개수 데이터 불러와서 넣을 곳
       console.log("노래방 방 개수: ");
       console.log(kkRoomCnt);
       let kkRoomList = ["2인실(1)", "2인실(2)", "2인실(3)", "2인실(4)", "4인실(1)", "4인실(2)", "단체실"];  // 노래방 방 정보 넣을 곳
       let dropBox = $(".label");

       // 방 선택 드롭박스에 불러온 방 정보 채우기
       for(let i=0; i<kkRoomList.length; i++) {
         $(".roomList").append("<li class='roomItem'>"+kkRoomList[i]+"</li>");
       }


       // 현재 날짜, 시간 정보
       let now = new Date();
       let currentHour = now.getHours();

       for (let i = 0; i < 24; i++) {
         let hour = currentHour + i;
         if (hour > 24) {
           hour = hour - 24;
         }
         $(".timeLine").append("<div class='time'>" + hour + ":00</div");
       }

       // 예약하기 버튼 클릭시, 예약하기 모달1 열기
       $("#reservationBtn").click(function () {
         $("#modal1").css("display", "flex");
       });

       // 예약하기 모달1 닫기
       $("#modal1 .closeBtn").on("click", function () {
         $("#modal1").css("display", "none");
       });

       $("#modal1 .btn.cancel").click(function() {
         $("#modal1").css("display", "none");
       })

       // 예약하기 모달 - 방 선택 드롭박스 열림/닫힘
       dropBox.click(function() {
         if($(this).parent().hasClass("active")) {
           $(this).parent().removeClass("active");
         } else {
           $(this).parent().addClass("active");
         }
       });

       // 예약하기 모달 - 드롭박스 - 선택한 방 종류 넘기기
       const options = $(".roomItem").get();
       const handleSelect = function(item) {
         dropBox.html(item.textContent);
         if(dropBox.parent().hasClass("active")) {
           dropBox.parent().removeClass("active");
         }
       }

       options.forEach(function(option) {
         option.addEventListener("click", function() {
           handleSelect(option);
         });
       });

       // 예약하기 모달 - 시간 설정폼
       // 년 월+1 일 요일(0: 일요일, 6: 토요일)
       let date = now.getFullYear()+"."+(now.getMonth()+1)+"."+now.getDate()+".";

       let currentYear = now.getFullYear();
       let currentMonth = now.getMonth()+1;
       let currentDate = now.getDate();
       let currentDay = now.getDay();
       switch(currentDay) {
         case 0:
           currentDay = "일";
           break;
         case 1:
           currentDay = "월";
           break;
         case 2:
           currentDay = "화";
           break;
         case 3:
           currentDay = "수";
           break;
         case 4:
           currentDay = "목";
           break;
         case 5:
           currentDay = "금";
           break;
         case 6:
           currentDay = "토";
           break;
       }

       $(".reservateDate").html(currentYear+"."+currentMonth+"."+currentDate+"("+currentDay+")");

       // 시작시간 설정 모달(modal2) 내용
       let startModalHourInput = $("#modal2 #hour input");
       let startMinuteHourInput = $("#modal2 #minute input");
       let startTimeInput = $("#startTime input");
       let timeType = "";
       const timeTypes = $(".timeType").get();

       // $(".searchDate").html(currentYear+"."+currentMonth+"."+currentDate+"("+currentDay+")");

       // 모달(modal2) 열기
       $("#startTime").on("click", function () {
         $("#modal2").css("display", "flex");
         let tmp1 = $("#hiddenTime1").val().split(":");
         startModalHourInput.val(tmp1[0]);
         startMinuteHourInput.val(tmp1[1]);

         if(startModalHourInput.val() < 12) {
           timeTypes[0].classList.add("active");
           timeTypes[1].classList.remove("active");
         } else if(startModalHourInput.val() >= 12) {
             timeTypes[0].classList.remove("active");
             timeTypes[1].classList.add("active");
         }
       });

       // AM, PM 선택한 div에 테두리 색 변경
       timeTypes.forEach(function (option) {
         option.addEventListener("click", function () {
           timeTypes.forEach(function (item) {
               item.classList.remove("active");
           });
           option.classList.add("active");
           timeType = option.innerHTML;
         });
       });

       // 모달2 시간에 따라 searchDate 오늘/내일로 변경
       $(document).ready(function() {
         $("#modal2 #hour input").on("input", function() {
           console.log($(this).val());
           if((timeType === "PM" && parseInt($(this).val())+12 < now.getHours()) || (timeType === "AM" && parseInt($(this).val()) < now.getHours())) {
             currentDay = now.getDay() + 1;
             switch(currentDay) {
               case 0:
                 currentDay = "일";
                 break;
               case 1:
                 currentDay = "월";
                 break;
               case 2:
                 currentDay = "화";
                 break;
               case 3:
                 currentDay = "수";
                 break;
               case 4:
                 currentDay = "목";
                 break;
               case 5:
                 currentDay = "금";
                 break;
               case 6:
                 currentDay = "토";
                 break;
             }
             console.log("계산한 날짜 및 시간");
             console.log(currentYear+"."+currentMonth+"."+(currentDate+1)+"("+(currentDay)+")");
             $(".searchDate").html(currentYear+"."+currentMonth+"."+(currentDate+1)+"("+currentDay+")");
           } else {
             $(".searchDate").html(currentYear+"."+currentMonth+"."+currentDate+"("+currentDay+")");
           }
         })
      });

       // $(".searchDate").html(currentYear+"."+currentMonth+"."+currentDate+"("+currentDay+")");

       // 모달(modal2) 취소(닫기)
       $("#modal2 .btn.cancel").click(function() {
         $("#modal2").css("display", "none");
       });


       // modal1의 시작시간(#hiddenTime1)이 변경되어 내일로 날짜가 바뀌면 업데이트하도록
       $("#modal2 #hour input").on("DOMSubtreeModified", function() {
         console.log($(this).val());
         if($("hiddenTime1").val() == "") {
           console.log("hiddenTime1 빈 값 상태");
           $(".reservateDate").html(currentYear+"."+currentMonth+"."+currentDate+"("+currentDay+")");
         } else {
           $(".reservateDate").html($(".searchDate").val());
         }
       });

       // 모달(modal2) 설정 버튼 클릭
       $("#modal2 .btn.setting").click(function() {
         console.log("모달2 설정버튼 클릭");
         let hour =  $("#modal2 #hour input").val();
         let minute = $("#modal2 #minute input").val();

         if(timeType == "") {
           alert("AM 또는 PM 시간대를 설정해주세요!");
         }
         if (startModalHourInput.val() === "" || startMinuteHourInput.val() === "") {
           alert("시, 분 모두 입력해주세요!");
           return;
         } else {
           if(hour > 12) {
               alert("'시'는 0~12 사이의 값으로 입력 가능합니다.");
           }
           if(minute > 59) {
               alert("'분'은 0~59사이의 값으로 입력 가능합니다.");
           }
           if(timeType === "PM") {
               hour = parseInt(hour) + 12;
           }
         }

         startTimeInput.val(hour + ":" + minute);
         $("#startTimeInput").val(hour + ":" + minute);
         $("#hiddenTime1").val(hour + ":" + minute);
         // // modal1의 시작시간(#hiddenTime1)이 변경되어 내일로 날짜가 바뀌면 업데이트하도록
         // $("#hiddenTime1").on("DOMSubtreeModified", function() {
         //   console.log($(this).val());
         //   if($("hiddenTime1").val() == "") {
         //     console.log("hiddenTime1 빈 값 상태");
         //     $(".reservateDate").html(currentYear+"."+currentMonth+"."+currentDate+"("+currentDay+")");
         //   } else {
         //     $(".reservateDate").html($(".searchDate").val());
         //   }
         // });

         // // 검색하는 시작 시간이 자정을 넘겨 내일이라면 reservateDate + 1
         // console.log("현재 시간 정보");
         // console.log(now.getHours);
         // console.log(now.getMinutes);
         // console.log("시작 시간 정보");
         // console.log(parseInt(hour));
         // console.log(parseInt(minute));

         if(now.getHours() >= 12 && parseInt(hour) < 12 && timeType === "AM") {
           console.log("지금 오후 12시인데 시작시간이 새벽 2시라면 5.21");
           currentDay = now.getDay() + 1;
           switch(currentDay) {
             case 0:
               currentDay = "일";
               break;
             case 1:
               currentDay = "월";
               break;
             case 2:
               currentDay = "화";
               break;
             case 3:
               currentDay = "수";
               break;
             case 4:
               currentDay = "목";
               break;
             case 5:
               currentDay = "금";
               break;
             case 6:
               currentDay = "토";
               break;
           }

           $(".reservateDate").html(currentYear+"."+currentMonth+"."+(currentDate+1)+"("+currentDay+")");

         }
         if(timeType==="PM" && parseInt(hour) < 12 && now.getHours() >= 12 && (parseInt(hour)+12) > now.getHours()) {
           console.log("지금 체크 else if");
           currentDay = now.getDay();
           switch(currentDay) {
             case 0:
               currentDay = "일";
               break;
             case 1:
               currentDay = "월";
               break;
             case 2:
               currentDay = "화";
               break;
             case 3:
               currentDay = "수";
               break;
             case 4:
               currentDay = "목";
               break;
             case 5:
               currentDay = "금";
               break;
             case 6:
               currentDay = "토";
               break;
           }
           $(".searchDate").html(currentYear+"."+currentMonth+"."+(currentDate)+"("+currentDay+")");
           $(".reservateDate").html(currentYear+"."+currentMonth+"."+(currentDate)+"("+currentDay+")");
         } //else if(timeType==="AM" && parseInt(hour) < 12 && now.getHours() >= 12 && (parseInt(hour)+12) > now.getHours()) {
         // $(".reservateDate").html(currentYear+"."+currentMonth+"."+currentDate+"("+currentDay+")");

           $("#modal2").css("display", "none");
         });


       // 이용시간 설정 모달(modal3) 내용
       let usingTimeModalHourInput = $("#modal3 #hour input");
       let usingTimeModalMinuteInput = $("#modal3 #minute input");
       let usingTimeInput = $("#hoursOfUse input");
       let useEndingTimeInput = $("#endTimeInput");
       let endingTime = "";
       // 모달(modal3) 열기
       $("#hoursOfUse").on("click", function () {
         $("#modal3").css("display", "flex");
       });
       // 모달(modal3) 닫기(취소)
       $("#modal3 .btn.cancel").on("click", function () {
         $("#modal3").css("display", "none");
       });
       // 모달(modal3) 설정 클릭 시,
       $("#modal3 .btn.setting").on("click", function() {
         console.log("모달3 설정 버튼 클릭!");
         let hour =  $("#modal3 #hour input").val();
         let minute = $("#modal3 #minute input").val();

         if(hour === "" && minute === "") {
           alert("이용하실 시간을 입력해주세요!");
           return;
         } else {
             if(hour === "" && minute !== "" && minute < 10) {
                 alert("최소 이용 시간은 10분입니다 :)");
                 return;
             }
             if(minute > 59) {
                 alert("'분'은 0~59 사이의 값으로 입력 가능합니다.");
                 return;
             }
             if(hour === "" && minute !== "" && minute > 10) {
                 hour = 0;
             }
             usingTimeInput.val(hour+":"+minute);
             $("#hiddenTime2").val(hour + ":" + minute);
             // $("#hiddenTime3").val(hour + ":" + minute);
         }

         // 이용 종료 시간 계산
         // 시작 시간의 'hour'
         let startHour = parseInt($("#hiddenTime1").val().split(":")[0]);
         // 시작 시간의 'minute'
         let startMinute = parseInt($("#hiddenTime1").val().split(":")[1]);
         // 이용 시간의 'hour' __hour 쓰면 됨
         // 이용 시간의 'minute' __minute 쓰면 됨
         let tmpHour;
         let tmpMinute;

         if(startMinute + parseInt(minute) > 59) {
           tmpHour = startHour + parseInt(hour) + 1;
           tmpMinute = startMinute + parseInt(minute) - 60;
           if(startHour + parseInt(hour) > 24) {
             tmpHour = startHour + parseInt(hour) - 24;
           }
         } else {
           tmpHour = startHour + parseInt(hour);
           tmpMinute = startMinute + parseInt(minute);
           if(startHour + parseInt(hour) > 24) {
             tmpHour = startHour + parseInt(hour) - 24;

             // 이용 종료 시간이 자정을 넘겨 내일 시도2
             let tmpDay1 = now.getDay();
             let tmpDay2 = now.getDay()+1;

             switch(tmpDay1) {
               case 0:
               tmpDay1 = "일";
                 break;
               case 1:
               tmpDay1 = "월";
                 break;
               case 2:
               tmpDay1 = "화";
                 break;
               case 3:
               tmpDay1 = "수";
                 break;
               case 4:
               tmpDay1 = "목";
                 break;
               case 5:
               tmpDay1 = "금";
                 break;
               case 6:
               tmpDay1 = "토";
                 break;
             }
             switch(tmpDay2) {
               case 0:
               tmpDay2 = "일";
                 break;
               case 1:
               tmpDay2 = "월";
                 break;
               case 2:
               tmpDay2 = "화";
                 break;
               case 3:
               tmpDay2 = "수";
                 break;
               case 4:
               tmpDay2 = "목";
                 break;
               case 5:
               tmpDay2 = "금";
                 break;
               case 6:
               tmpDay2 = "토";
                 break;
             }

             $(".reservateDate").html(currentYear+"."+currentMonth+"."+now.getDate()+"("+tmpDay1+")"
            +" ~ " + currentYear+"."+currentMonth+"."+(now.getDate()+1)+"("+tmpDay2+")");
           }
         }

         endingTime = tmpHour + ":" + tmpMinute;
         console.log(endingTime);

          // 이용 종료시간이 자정을 넘겨 내일이라면 reservateDate + 1
          console.log("이용 종료시간이 자정 넘겨 내일 ...");
          console.log("시작시간(modal1)");
          let modal1TimeInfo = $("#hiddenTime1").val().split(":");
          let modal1Hour = modal1TimeInfo[0];
          let modal1Minute = modal1TimeInfo[1];

          // reservateDate에 표기할 년, 월, 일, 시, 요일
          let reservateYear = currentYear;
          let reservateMonth = currentMonth;
          let reservateDate = currentDate;
          let reservateDay = now.getDay();

          /*
          if((now.getHours() < 12 && now.getHours() > modal1Hour) || (now.getHours() > 12 && now.getHours() > modal1Hour)) {
           let tmpDay = now.getDay();
           switch(tmpDay) {
             case 0:
             tmpDay = "일";
               break;
             case 1:
             tmpDay = "월";
               break;
             case 2:
             tmpDay = "화";
               break;
             case 3:
             tmpDay = "수";
               break;
             case 4:
             tmpDay = "목";
               break;
             case 5:
             tmpDay = "금";
               break;
             case 6:
             tmpDay = "토";
               break;
           }
           $(".reservateDate").html(currentYear+"."+currentMonth+"."+(now.getDate()+1)+"("+tmpDay+")");
          } else if(now.getHours() > 12 && modal1Hour > now.getHours() && modal1Hour < 24 && tmpHour < modal1Hour) {
           let tmpDay1 = now.getDay();
           let tmpDay2 = now.getDay()+1;

           switch(tmpDay1) {
             case 0:
             tmpDay1 = "일";
               break;
             case 1:
             tmpDay1 = "월";
               break;
             case 2:
             tmpDay1 = "화";
               break;
             case 3:
             tmpDay1 = "수";
               break;
             case 4:
             tmpDay1 = "목";
               break;
             case 5:
             tmpDay1 = "금";
               break;
             case 6:
             tmpDay1 = "토";
               break;
           }
           switch(tmpDay2) {
             case 0:
             tmpDay2 = "일";
               break;
             case 1:
             tmpDay2 = "월";
               break;
             case 2:
             tmpDay2 = "화";
               break;
             case 3:
             tmpDay2 = "수";
               break;
             case 4:
             tmpDay2 = "목";
               break;
             case 5:
             tmpDay2 = "금";
               break;
             case 6:
             tmpDay2 = "토";
               break;
           }

           $(".reservateDate").html(currentYear+"."+currentMonth+"."+currentDate+"("+tmpDay1+")"
            +" ~ " + currentYear+"."+currentMonth+"."+(currentDate+1)+"("+tmpDay2+")");
          } else {$(".reservateDate").html(currentYear+"."+currentMonth+"."+(currentDate)+"("+(currentDay)+")");

          }
          */
         // if((now.getHours() < 12) && (now.getHours() + parseInt(hour) > 23)) {
         //   $(".reservateDate").html(currentYear+"."+currentMonth+"."+currentDate+"("+currentDay+")"
         // +" ~ " + currentYear+"."+currentMonth+"."+(currentDate+1)+"("+(currentDay+1)+")");
         // } else if ((now.getHours > 12) && (now.getHours() + parseInt(hour) > 23)) {
         //   $(".reservateDate").html(currentYear+"."+currentMonth+"."+currentDate+"("+currentDay+")");
         // }

         useEndingTimeInput.val(tmpHour + ":" + tmpMinute);
         $("#hiddenTime3").val(tmpHour + ":" + tmpMinute);
         // useEndingTimeInput.val(endingTime);
         // $("#hiddenTime3").val(endingTime);

         $("#modal3").css("display", "none");
       })

       // 예약하기 모달 -> 예약확인 모달
       $("#modal1 .btn.submit").on("click", function() {
         console.log($("#modal1 .label").text());
         console.log($("#modal1 #hiddenTime1").val());
         console.log($("#modal1 #hiddenTime2").val());
         console.log($("#modal1 #hiddenTime3").val());

         if(($("#modal1 .label").text() == "예약하실 방을 선택해주세요.") || ($("#modal1 #hiddenTime1").val() == "") || ($("#modal1 #hiddenTime2").val() == "")) {
           alert("예약하실 방, 이용 시작 시간, 이용 시간 모두 입력해주세요!");
         } else {
           $("#modal4 .kkRoomName").html($("header span").text());
           $("#modal4 .kkRoomType").html($("#modal1 .label").text());
           $("#modal4 .reservateDate").html($("#modal1 .reservateDate").text());
           $("#modal4 #hiddenTime3").val($("#modal1 #hiddenTime3").val());

           $("#modal4").css("display", "flex");
         }
       })

       // 예약확인 모달(#modal4) 창 닫기
       // 예약하기 모달1 닫기
       $("#modal4 .closeBtn").on("click", function () {
         $("#modal4").css("display", "none");
       });

       // 예약확인 모달 '이전'버튼 클릭 -> 예약 모달(#modal1)
       // 예약하기 모달1 닫기
       $("#modal4 .btn.back").on("click", function () {
         $("#modal4").css("display", "none");
       });

       // 예약확인 모달의 '결제' 버튼 클릭하면 결제 및 예약 최종 완료
       $("#modal4 .btn.submit").on("click", function () {
         $("#modal1").css("display", "none");
         $("#modal4").css("display", "none");
         // $("#modal5").css("display", "flex");
         // (비동기)결제 요청 보내기 -> 서버 요청 결과에 따라 #modal5를 보여주거나, 예약에 실패하거나의 결과
         async function() {
           // Fetch 요청 옵션
           const fetchOptions = {
             method: "POST",
             headers: {
               "Content-Type": "application/json", // 요청 본문 형식
             },
             body: JSON.stringify({}), // 전송할 JSON 데이터
           };

           // Fetch 요청 전송
           try {
             const response = await fetch("/api/addReservation", fetchOptions);
             const responseData = await response.json();

             if(responseData.success) {
               console.log("예약 성공!");
             } else {
               console.error("예약 실패", responseData.message);
             }
           } catch(error) {
             console.log("Fetch요청 오류", error);
           }
         }
       });

       // 예약 최종 모달(#modal5)의 '나의 예약 보기' 클릭 -> 마이페이지 예약내역
       $("#modal5 .btn").on("click", function() {
         alert("마이페이지 - 예약 내역으로 이동!");
         $("#modal5").css("display", "none");
       })
    </script>
  </body>
</html>
