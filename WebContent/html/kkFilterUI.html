<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0"
    />
    <title>:: 노래방 검색</title>
    <link
      rel="stylesheet"
      href="../css/kkFilterUI.css"
    />
    <link
      rel="stylesheet"
      href="../css/common.css"
    />
    <link
      rel="preconnect"
      href="https://fonts.googleapis.com"
    />
    <link
      rel="preconnect"
      href="https://fonts.gstatic.com"
      crossorigin
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@100..900&display=swap"
      rel="stylesheet"
    />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
  </head>
  <body>
    <!-- 모바일 컨테이너 -->
    <div id="mobileContainer">
      <!--헤더-->
      <header>
        <img
          src="../img/left arrow.svg"
          alt="이전 페이지 이동"
        />
        <span>노래방 검색</span>
      </header>
      <!-- 컨텐츠 컨테이너 -->
      <div id="container">
        <div id="regionWrapper">
          <p class="subTitle">지역</p>
          <div class="regionBox">
            <button class="label">이용 지역을 선택해주세요.</button>
            <img
              src="../img/down arrow.svg"
              alt="드롭다운"
            />
            <ul class="regionList">
              <li class="regionItem">서울 전체</li>
              <li class="regionItem">강남구</li>
              <li class="regionItem">강동구</li>
              <li class="regionItem">강북구</li>
              <li class="regionItem">강서구</li>
              <li class="regionItem">관악구</li>
              <li class="regionItem">광진구</li>
              <li class="regionItem">구로구</li>
              <li class="regionItem">금천구</li>
              <li class="regionItem">노원구</li>
              <li class="regionItem">도봉구</li>
              <li class="regionItem">동대문구</li>
              <li class="regionItem">동작구</li>
              <li class="regionItem">마포구</li>
              <li class="regionItem">서대문구</li>
              <li class="regionItem">서초구</li>
              <li class="regionItem">성동구</li>
              <li class="regionItem">성북구</li>
              <li class="regionItem">송파구</li>
              <li class="regionItem">양천구</li>
              <li class="regionItem">영등포구</li>
              <li class="regionItem">용산구</li>
              <li class="regionItem">은평구</li>
              <li class="regionItem">종로구</li>
              <li class="regionItem">중구</li>
              <li class="regionItem">중랑구</li>
            </ul>
          </div>
          <!-- <select id="region" name="region">
                    <option value="">이용 지역을 선택해주세요.</option>
                    <option value="강남구">강남구</option>
                    <option value="강동구">강동구</option>
                    <option value="강북구">강북구</option>
                    <option value="강서구">강서구</option>
                    <option value="관악구">관악구</option>
                    <option value="광진구">광진구</option>
                    <option value="구로구">구로구</option>
                    <option value="금천구">금천구</option>
                    <option value="노원구">노원구</option>
                    <option value="도봉구">도봉구</option>
                    <option value="동대문구">동대문구</option>
                    <option value="동작구">동작구</option>
                    <option value="마포구">마포구</option>
                    <option value="서대문구">서대문구</option>
                    <option value="서초구">서초구</option>
                    <option value="성동구">성동구</option>
                    <option value="성북구">성북구</option>
                    <option value="송파구">송파구</option>
                    <option value="양천구">양천구</option>
                    <option value="영등포구">영등포구</option>
                    <option value="용산구">용산구</option>
                    <option value="은평구">은평구</option>
                    <option value="종로구">종로구</option>
                    <option value="중구">중구</option>
                    <option value="중랑구">중랑구</option>
                </select>  -->
        </div>
        <div id="timeWrapper">
          <p class="subTitle">검색 시간대 및 이용시간</p>
          <div class="timeItemWrapper">
            <p>검색 시간대</p>
            <div id="timeSettingWrapper">
              <div
                id="startTime"
                class="timeSettingItem"
              >
              <input
              id="hiddenTime1"
              type="hidden"
            />
                <input
                    id="startTimeInput"
                  readonly
                  placeholder="-- : --"
                  value=""
                />
                <img
                  src="../img/down arrow.svg"
                  alt="드롭다운"
                />
              </div>
              <span>~</span>
              <div
                id="endTime"
                class="timeSettingItem"
              >
              <input
              id="hiddenTime2"
              type="hidden"
            />
                <input
                  readonly
                  placeholder="-- : --"
                  value=""
                />
                <img
                  src="../img/down arrow.svg"
                  alt="드롭다운"
                />
              </div>
              <div
                id="searchTimeModal1"
                class="modal searchTime"
              >
                <div class="modalContent">
                  <p id="startDate">2024.05.16(목)</p>
                  <div class="timeSettingWrapper">
                    <div class="timeTypeWrapper">
                      <div class="timeType">AM</div>
                      <div class="timeType">PM</div>
                    </div>
                    <div class="timeWrapper">
                      <div
                        id="hour"
                        class="time"
                      >
                        <p>시</p>
                        <input
                          name="hour"
                          type="number"
                        />
                      </div>
                      <span>:</span>
                      <div
                        id="minute"
                        class="time"
                      >
                        <p>분</p>
                        <input
                          name="minute"
                          type="number"
                          required
                        />
                      </div>
                    </div>
                  </div>
                  <div class="btnWrapper">
                    <div class="btn cancel">취소</div>
                    <div class="btn setting">설정</div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="timeItemWrapper item3">
            <p>이용 시간</p>
            <div
              id="hoursOfUse"
              class="timeSettingItem item3"
            >
              <input
                readonly
                placeholder="-- : --"
              />
              <img
                src="../img/down arrow.svg"
                alt="드롭다운"
              />
            </div>
          </div>
          <div
            id="usingTimeModal"
            class="modal usingTime"
          >
            <div class="modalContent">
                <div class="closeIconWrapper">
                    <img
                    src="../img/close.svg"
                    alt="모달창 닫기"
                    class="closeBtn"
                    />
                </div>
              <p class="subTitle">이용 시간</p>
              <div class="timeWrapper">
                <div
                  id="hour"
                  class="time"
                >
                  <p>시</p>
                  <input
                    name="hour"
                    type="number"
                  />
                </div>
                <span>:</span>
                <div
                  id="minute"
                  class="time"
                >
                  <p>분</p>
                  <input
                    name="minute"
                    type="number"
                    required
                  />
                </div>
              </div>
              <div id="usingTimeSettingBtn" class="btn">설정</div>
            </div>
          </div>
        </div>
        <div id="additionalOptionWrapper">
          <p class="subTitle">추가 조건</p>
          <div class="optionsWrapper">
            <div class="optionItem">
              <img
                src="../img/Car.svg"
                alt="주차 가능 아이콘"
              />
              <p class="optionName">주차 가능</p>
            </div>
            <div class="optionItem">
              <img
                src="../img/up.svg"
                alt="지상층 아이콘"
              />
              <p class="optionName">지상층</p>
            </div>
            <div class="optionItem">
              <img
                src="../img/ThermometerHalf.svg"
                alt="냉난방 아이콘"
              />
              <p class="optionName">냉난방</p>
            </div>
            <div class="optionItem">
              <img
                src="../img/users.svg"
                alt="단체 아이콘"
              />
              <p class="optionName">단체 가능</p>
            </div>
          </div>
        </div>
        <button>검색</button>
      </div>
      <!-- 하단 메뉴바 -->
      <nav>
        <div>
          <img
            src="../img/mainPageIcon.svg"
            alt="메인 페이지"
          />
        </div>
        <div>
          <img
            src="../img/searchIcon.svg"
            alt="노래방 검색 페이지"
          />
        </div>
        <div>
          <img
            src="../img/musicIcon.svg"
            alt="노래 검색 페이지"
          />
        </div>
        <div>
          <img
            src="../img/reservationIcon.svg"
            alt="나의 예약 내역 페이지"
          />
        </div>
        <div>
          <img
            src="../img/userIcon.svg"
            alt="마이페이지"
          />
        </div>
      </nav>
    </div>
    <script>
      const label = document.querySelector(".label");
      const options = document.querySelectorAll(".regionItem");
      const searchOptions = document.querySelectorAll(".optionItem");
      // const timeTypes = document.querySelectorAll(".timeType");
      // let timeType = "";

      // 클릭한 옵션의 텍스트를 라벨 안에 넣음
      const handleSelect = function (item) {
        label.innerHTML = item.textContent;
        label.parentNode.classList.remove("active");
      };
      // 옵션 클릭시 클릭한 옵션을 넘김
      options.forEach(function (option) {
        option.addEventListener("click", function () {
          handleSelect(option);
        });
      });
      // 라벨을 클릭시 옵션 목록이 열림/닫힘
      label.addEventListener("click", function () {
        if (label.parentNode.classList.contains("active")) {
          label.parentNode.classList.remove("active");
        } else {
          label.parentNode.classList.add("active");
        }
      });
      // 옵션 아이템 클릭시 테두리 색상 변경
      searchOptions.forEach(function (option) {
        option.addEventListener("click", function () {
          // 클릭한 옵션 아이템에만 active 클래스 추가
          option.classList.toggle("active");
          const svg = option.querySelector("img");
          svg.style.fill = option.classList.contains("active")
            ? "#e3cdff"
            : "currentColor";
        });
      });

      // 모달
      // 모달 가져오기
      var modal = document.getElementById("searchTimeModal");
      // var timeSettingItems = document.querySelectorAll(".timeSettingItem");
      // var startTimeBtn = document.getElementById("startTime");
      // var entTimeBtn = document.getElementById("endTime");
      // 모달 닫기 버튼(취소) 가져오기
      var cancelBtn = document.querySelector(".btn.cancel");

    //   startTimeBtn.addEventListener("click", function () {
    //     modal.style.display = "flex";
    //   });

      cancelBtn.addEventListener("click", function () {
        console.log("취소 버튼 클릭");
        modal.style.display = "none";
      });

      $(document).ready(function () {
        const modal = $("#searchTimeModal1");
        let searchType = 0;  // 0: 시작 시간대, 1: 종료 시간대
        let startTimeInput = $("#startTime input");
        let endTimeInput = $("#endTime input");
        let startModalHourInput = $("#searchTimeModal1 #hour input");
        let startMinuteHourInput = $("#searchTimeModal1 #minute input");
        const timeTypes = $(".timeType").get();
        let timeType = "";
        const cancelBtn = $(".btn.cancel");
        const settingBtn = $(".btn.setting");

        const modal2 = $("#usingTimeModal");
        let usingTimeInput = $("#hoursOfUse");
        let usingModalHourInput = $("#usingTimeModal #hour input");
        let usingModalMinuteInput = $("#usingTimeModal #minute input");
        const usingTimeSettingBtn = $("#usingTimeSettingBtn");

        // 검색시간대 - 시작 모달 열기
        $("#startTime").on("click", function () {
            searchType = 0;
            // startModalHourInput.val($("#hiddenTime1").val);
            let tmp1 = $("#hiddenTime1").val().split(" : ");
            // console.log(tmp1);
            // console.log(typeof(tmp1));
            // console.log(tmp1[0]);
            // console.log(tmp1[1]);
            startModalHourInput.val(tmp1[0]);
            startMinuteHourInput.val(tmp1[1]);

            // if(startModalHourInput.val() < 12) {
            //     timeTypes[0].classList.add("active");
            //     timeTypes[1].classList.remove("active");
            // } else if(timeType === "PM") {
            //     timeTypes[0].classList.remove("active");
            //     timeTypes[1].classList.add("active");
            // }
            if(startModalHourInput.val() < 12) {
                timeTypes[0].classList.add("active");
                timeTypes[1].classList.remove("active");
            } else if(startModalHourInput.val() >= 12) {
                timeTypes[0].classList.remove("active");
                timeTypes[1].classList.add("active");
            }
          modal.css("display", "flex");
        });
        // 검색시간대 - 종료 모달 열기
        $("#endTime").on("click", function () {
            searchType = 1;
            let tmp2 = $("#hiddenTime2").val().split(" : ");
            // console.log(tmp1);
            // console.log(typeof(tmp1));
            // console.log(tmp1[0]);
            // console.log(tmp1[1]);
            startModalHourInput.val(tmp2[0]);
            startMinuteHourInput.val(tmp2[1]);
            if(startModalHourInput.val() < 12) {
                timeTypes[0].classList.add("active");
                timeTypes[1].classList.remove("active");
            } else if(startModalHourInput.val() >= 12) {
                timeTypes[0].classList.remove("active");
                timeTypes[1].classList.add("active");
            }
          modal.css("display", "flex");
        });

        cancelBtn.on("click", function () {
          modal.css("display", "none");
        });

        // AM, PM 선택한 div에 테두리 색 변경
        timeTypes.forEach(function (option) {
            option.addEventListener("click", function () {
            timeTypes.forEach(function (item) {
                item.classList.remove("active");
            });
            option.classList.add("active");
                timeType = option.innerHTML;
            });
        });

        settingBtn.on("click", function () {
          let hour = startModalHourInput.val();
          let minute = startMinuteHourInput.val();

          if(timeType == "") {
            alert("AM 또는 PM 시간대를 설정해주세요!");
          }
          if (startModalHourInput.val() === "" || startMinuteHourInput.val() === "") {
            alert("시, 분 모두 입력해주세요!");
            return;
          } else {
            if(hour > 12) {
                alert("'시'는 0~12 사이의 값으로 입력 가능합니다.");
            }
            if(minute > 59) {
                alert("'분'은 0~59사이의 값으로 입력 가능합니다.");
            }
            if(timeType === "PM") {
                // hour = hour + 12;
                hour = parseInt(hour) + 12;
            }
          }

          if(searchType === 0) {
            startTimeInput.val(hour + " : " + minute);
            $("#startTimeInput").val(hour + " : " + minute);
            $("#hiddenTime1").val(hour + " : " + minute);
            // console.log("#hiddenTime1");
            // console.log($("#hiddenTime1").val());
            // console.log(typeof($("#hiddenTime1").val()));
            // let tmp1 = $("#hiddenTime1").val().split(" : ");
            // console.log(tmp1);
            // console.log(typeof(tmp1));
            // console.log(tmp1[0]);
            // console.log(tmp1[1]);
        } else if(searchType === 1) {
            // console.log("종료 시간대");
            endTimeInput.val(hour + " : " + minute);
            $("#hiddenTime2").val(hour + " : " + minute);
            // console.log("#hiddenTime2");
            // console.log($("#hiddenTime2").val());
            // console.log(typeof($("#hiddenTime2").val()));
            // let tmp2 = $("#hiddenTime2").val().split(" : ");
            // console.log(tmp2);
            // console.log(typeof(tmp2));
            // console.log(tmp2[0]);
            // console.log(tmp2[1]);
          }

          modal.css("display", "none");
        });

        // 이용시간 설정 모달 열기
        $("#hoursOfUse").on("click", function () {
          $("#usingTimeModal").css("display", "flex");
        });

        // 이용시간 모달 닫기
        $("#usingTimeModal .closeBtn").on("click", function () {
          $("#usingTimeModal").css("display", "none");
        });

        usingTimeSettingBtn.on("click", function() {
            let hour = usingModalHourInput.val();
            let minute = usingModalMinuteInput.val();

            if(hour === "" && minute === "") {
                alert("이용하실 시간을 입력해주세요!");
                return;
            } else {
                if(hour === "" && minute !== "" && minute < 10) {
                    alert("최소 이용 시간은 10분입니다 :)");
                }
                if(minute > 59) {
                    alert("'분'은 0~59 사이의 값으로 입력 가능합니다.");
                }
            }
        })

        
      });
    </script>
  </body>
</html>
